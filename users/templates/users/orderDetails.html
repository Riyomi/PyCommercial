{% extends 'base.html' %}
{% load products.productfilters %}
{% block title %}My Orders{% endblock title %}

{% block content %}
<div class="flex flex-col mx-auto rounded-lg lg:w-1/2 md:w-4/6 mt-4 bg-white">
  <p class="font-semibold text-2xl background-color text-white px-6 py-2 rounded-t-lg">Order #{{ order }}</p>
 
  <div class="flex flex-col mx-4 my-2 self-justify-center border mb-4">
    <div>
      <p class="text-white background-color px-4 py-1 rounded-t">Order information</p>
      <div class="px-6 py-1">
        <p>ID: #{{ order }}</p>
        <p>Placed on: {{ order.date_placed|date:"d/m/Y G:i" }}</p>
      </div>
    </div>

    <div >
      <p class="text-white background-color px-4 py-1">Customer information</p>
      <div class="px-6 py-1">
        <p>{{ order.first_name }} {{ order.last_name }}</p>
        <p>{{ order.email }}</p>
        <p>{{ order.mobile }}</p>
      </div>
    </div>

    <div>
      <p class="text-white background-color px-4 py-1">Delivery information</p>
      <p class="px-6 py-1">{{ order.address }}, {{ order.city }}, {{ order.country }}</p>
    </div>

    <div>
      <p class="text-white background-color px-4 py-1">Payment information</p>
      <div class="px-6 py-1">
        <p>{{ order.payment.name }}</p>
        <p>{{ order.payment.number|hide_credit_card_info }}</p>
        <p>{{ order.payment.expiry_date }}</p>
      </div>
    </div>

    <div class="mb-4">  
      <p class="text-white background-color px-4 py-1 mb-4">Status</p>
      <div class="flex justify-between">
        {% for status in order.get_status_choices %}
          {% if status.0 <= order.status %}
            <div class="stepper-item completed">
              <div class="step-counter">âœ“</div>
              <div class="step-name">{{status.1}}</div>
            </div>
          {% else %}
            <div class="stepper-item">
              <div class="step-counter"></div>
              <div class="step-name">{{status.1}}</div>
            </div>
          {% endif %}
        {% endfor %}
      </div>
    </div>

    <div>
      <p class="text-white background-color px-4 py-1">Products</p>
      <div class="w-full rounded-lg">
        {% for item in items %}
          <div class="order-items">
            <span>
              <a href="{% url 'products:details' item.product.id %}" class="flex">
                <div class="w-32 inline-block">
                 <img src="{{ item.product.image.url|formaturl }}" class="max-h-24 mx-auto" />
                </div>
                <span class="self-center"> {{ item.product.name }} </span>
              </a>
            </span>
            <span class="self-center">x{{ item.quantity }}</span>
            <span class="self-center mx-auto">${{ item.product.price }}</span>
            <span class="self-center mx-auto">${% widthratio item.product.price 1 item.quantity %}</span>
          </div>
        {% endfor %}
      </div>  

      <div class="order-total">
        <span>Total</span>
        <span class=" mx-auto">${{ order.total }}</span>
      </div>
    </div>
  </div>

</div>
{% endblock content %}
